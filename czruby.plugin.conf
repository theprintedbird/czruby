# Sets up an array to store the paths of the different Ruby versions.
export -TU RUBIES rubies

# Sets up an array to store the paths for the Gems associated with different Ruby versions.
export -TU GEM_PATH gem_path

# Defines the directory to store configuration files for different Ruby versions.
czruby_datadir="$XDG_DATA_HOME/czruby"

# Ensures a default Ruby is set if none has been previously defined.
if [[ -z "$RUBIES_DEFAULT" ]]; then
	export RUBIES_DEFAULT="system"
fi

# Portable realpath - use grealpath on macOS, realpath on Linux
if command -v grealpath > /dev/null 2>&1; then
	alias czruby_realpath='grealpath'
elif command -v realpath > /dev/null 2>&1; then
	alias czruby_realpath='realpath'
else
	# Fallback using readlink
	czruby_realpath() {
		if command -v greadlink > /dev/null 2>&1; then
			greadlink -f "$@"
		elif [[ "$(uname -s)" == "Darwin" ]]; then
			# macOS readlink doesn't have -f, use perl fallback
			perl -MCwd -le 'print Cwd::abs_path(shift)' "$1"
		else
			readlink -f "$@"
		fi
	}
fi